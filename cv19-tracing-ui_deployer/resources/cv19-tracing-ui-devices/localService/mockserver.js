sap.ui.define(["sap/ui/core/util/MockServer","sap/ui/model/json/JSONModel","sap/base/Log","sap/base/util/UriParameters"],function(e,t,r,a){"use strict";var i,o="covid19/ui/devicesmanagement/cv19-tracing-ui-devices/",n=o+"localService/mockdata";var s={init:function(s){var u=s||{};return new Promise(function(s,c){var p=sap.ui.require.toUrl(o+"manifest.json"),d=new t(p);d.attachRequestCompleted(function(){var t=new a(window.location.href),c=sap.ui.require.toUrl(n),p=d.getProperty("/sap.app/dataSources/mainService"),f=sap.ui.require.toUrl(o+p.settings.localUri),l=/.*\/$/.test(p.uri)?p.uri:p.uri+"/";l=l&&new URI(l).absoluteTo(sap.ui.require.toUrl(o)).toString();if(!i){i=new e({rootUri:l})}else{i.stop()}e.config({autoRespond:true,autoRespondAfter:u.delay||t.get("serverDelay")||500});i.simulate(f,{sMockdataBaseUrl:c,bGenerateMissingMockData:true});var v=i.getRequests();var m=function(e,t,r){r.response=function(r){r.respond(e,{"Content-Type":"text/plain;charset=utf-8"},t)}};if(u.metadataError||t.get("metadataError")){v.forEach(function(e){if(e.path.toString().indexOf("$metadata")>-1){m(500,"metadata Error",e)}})}var g=u.errorType||t.get("errorType"),h=g==="badRequest"?400:500;if(g){v.forEach(function(e){m(h,g,e)})}i.setRequests(v);i.start();r.info("Running the app with mock data");s()});d.attachRequestFailed(function(){var e="Failed to load application manifest";r.error(e);c(new Error(e))})})},getMockServer:function(){return i}};return s});